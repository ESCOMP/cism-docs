

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>6. Controlling output from CLM and CISM &#8212; CESM Land Ice CESM2.0 documentation</title>
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. Acknowledgments" href="acknowledgements.html" />
    <link rel="prev" title="5. Ice sheets in the Community Land Model, and glacier-land coupling" href="ice-sheets-in-clm.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="acknowledgements.html" title="7. Acknowledgments"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ice-sheets-in-clm.html" title="5. Ice sheets in the Community Land Model, and glacier-land coupling"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CESM Land Ice CESM2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">6. Controlling output from CLM and CISM</a><ul>
<li><a class="reference internal" href="#controlling-cism-output">6.1. Controlling CISM output</a></li>
<li><a class="reference internal" href="#producing-land-ice-specific-output-from-clm">6.2. Producing land ice-specific output from CLM</a><ul>
<li><a class="reference internal" href="#outputting-forcing-fields-sent-from-clm-to-cism">6.2.1. Outputting forcing fields sent from CLM to CISM</a></li>
<li><a class="reference internal" href="#adding-a-clm-history-field-that-provides-averages-only-over-ice">6.2.2. Adding a CLM history field that provides averages only over ice</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ice-sheets-in-clm.html"
                        title="previous chapter">5. Ice sheets in the Community Land Model, and glacier-land coupling</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="acknowledgements.html"
                        title="next chapter">7. Acknowledgments</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/controlling-output.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="controlling-output-from-clm-and-cism">
<span id="controlling-output"></span><h1>6. Controlling output from CLM and CISM<a class="headerlink" href="#controlling-output-from-clm-and-cism" title="Permalink to this headline">¶</a></h1>
<p>FIXME: bring this section up to date.</p>
<div class="section" id="controlling-cism-output">
<h2>6.1. Controlling CISM output<a class="headerlink" href="#controlling-cism-output" title="Permalink to this headline">¶</a></h2>
<p>Model history frequency is controlled by <em>HIST_OPTION</em> and <em>HIST_N</em> in
<em>env_run.xml</em>. By default, history files are written once a year. Among
the standard fields written to the history file are the ice thickness
(<em>thk</em>), upper surface elevation (<em>usurf</em>), bedrock elevation (<em>topg</em>)
along with the surface mass balance (<em>acab</em>) and surface air temperature
(<em>artm</em>) downscaled to the ice sheet grid; these fields are set by the
variable <em>cesm_history_vars</em> in <em>cism_in</em>.</p>
<p>Model restart frequency is coordinated by the CESM coupler. The restart
or hotstart file contains all the fields required for exact restart.
However, the restart will be exact only if the file is written
immediately after an ice dynamics time step. This will normally be the
case for restart files written at the end of any model year.</p>
<p>Many other fields can be written out if desired, simply by adding them
to the variable list, <em>cesm_history_vars</em>. The source files with names
“*_io.F90” specify the fields than can be written out. The easiest way
to write out new variables is to add them to a file ending in “vars.def”
and then rebuild the “*_io.F90” files using a python script. The
necessary script can be found in $CASEROOT/Buildconf/cismIOconf. See the
README.cismIO file in that directory for details.</p>
</div>
<div class="section" id="producing-land-ice-specific-output-from-clm">
<h2>6.2. Producing land ice-specific output from CLM<a class="headerlink" href="#producing-land-ice-specific-output-from-clm" title="Permalink to this headline">¶</a></h2>
<div class="section" id="outputting-forcing-fields-sent-from-clm-to-cism">
<h3>6.2.1. Outputting forcing fields sent from CLM to CISM<a class="headerlink" href="#outputting-forcing-fields-sent-from-clm-to-cism" title="Permalink to this headline">¶</a></h3>
<p>CLM sends three sets of fields to CISM, for each elevation class: <em>qice,
tsrf</em> and <em>topo</em> (see Section 5.2). It can often be useful to view the
values of these forcing fields for each elevation class within each grid
cell. To do this, you can use the three CLM history variables,
<em>QICE_FORC, TSRF_FORC</em> and <em>TOPO_FORC.</em> These history variables are
inactive by default, but can be added to any of CLM’s history files
using the <em>hist_fincl</em> CLM namelist variables. For example, to add
<em>QICE_FORC</em> and <em>TSRF_FORC</em> to CLM’s default (monthly) history file,
you would add the following in <em>user_nl_clm</em>:</p>
<p>hist_fincl1 = ‘QICE_FORC’,’TSRF_FORC’</p>
<p>As with other CLM history variables, additional history files can be
created with different time frequencies. See the CLM User’s Guide for
details on how to do this.</p>
</div>
<div class="section" id="adding-a-clm-history-field-that-provides-averages-only-over-ice">
<h3>6.2.2. Adding a CLM history field that provides averages only over ice<a class="headerlink" href="#adding-a-clm-history-field-that-provides-averages-only-over-ice" title="Permalink to this headline">¶</a></h3>
<p>In general, CLM history fields give weighted averages over the entire
grid cell. If you are interested in diagnostics just over ice landunits
for certain history fields, you can make a source code modification for
each field of interest. This is done in
<em>models/lnd/clm/src/main/histFldsMod.F90</em>: Find the history field(s) of
interest in this file, and add the following optional argument to the
<em>hist_addfld1d</em> or <em>hist_addfld2d</em> call for that history field:
<em>l2g_scale_type=’ice’</em>. You may want to copy and paste the call in
order to maintain the original history field and add a new field that
applies just over ice (being sure to change <em>fname</em>). For example,
examine the difference between the fields <em>TSOI</em> and <em>TSOI_ICE</em>:</p>
<p>call hist_addfld2d (fname=’TSOI’, units=’K’, type2d=’levgrnd’, &amp;</p>
<p>avgflag=’A’, long_name=’soil temperature (vegetated landunits only)’, &amp;</p>
<p>ptr_col=clm3%g%l%c%ces%t_soisno, l2g_scale_type=’veg’)</p>
<p>call hist_addfld2d (fname=’TSOI_ICE’, units=’K’, type2d=’levgrnd’, &amp;</p>
<p>avgflag=’A’, long_name=’soil temperature (ice landunits only)’, &amp;</p>
<p>ptr_col=clm3%g%l%c%ces%t_soisno, l2g_scale_type=’ice’)</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="acknowledgements.html" title="7. Acknowledgments"
             >next</a> |</li>
        <li class="right" >
          <a href="ice-sheets-in-clm.html" title="5. Ice sheets in the Community Land Model, and glacier-land coupling"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CESM Land Ice CESM2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Gunter Leguy, William Lipscomb, Bill Sacks.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>