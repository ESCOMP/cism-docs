

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>6. Remapping surface mass balance from CLM to CISM &#8212; CESM Land Ice CESM2.0 documentation</title>
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. Acknowledgments" href="acknowledgements.html" />
    <link rel="prev" title="5. Controlling output from CISM and CLM" href="controlling-output.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="acknowledgements.html" title="7. Acknowledgments"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="controlling-output.html" title="5. Controlling output from CISM and CLM"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CESM Land Ice CESM2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="controlling-output.html"
                        title="previous chapter">5. Controlling output from CISM and CLM</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="acknowledgements.html"
                        title="next chapter">7. Acknowledgments</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/smb-remapping.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="remapping-surface-mass-balance-from-clm-to-cism">
<span id="smb-remapping"></span><h1>6. Remapping surface mass balance from CLM to CISM<a class="headerlink" href="#remapping-surface-mass-balance-from-clm-to-cism" title="Permalink to this headline">¶</a></h1>
<p>As described above (link?), the surface mass balance (SMB) of ice sheets is computed by CLM
for each column (i.e., elevation class) of each glaciated landunit in each grid cell on the land grid.
The SMB is then remapped by the coupler to the finer ice sheet grid and passed to CISM.
When CESM is run with interactive coupling between glaciers and ice sheets, we want to conserve
the total amount of water in the system, while also mapping SMB smoothly and accurately between grids.</p>
<p>More precisely, we would like the SMB remapping to satisfy the following requirements:</p>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">Conservation</span></code>: For any ice sheet defined by a CISM domain, the sum over CLM grid cells of the SMB sent to the coupler
is equal (within machine roundoff) to the sum over CISM grid cells of the SMB received from the coupler.
Note this this is a global rather than a local requirement.</li>
<li><code class="docutils literal notranslate"><span class="pre">Smoothness</span></code>: The remapping is smooth and continuous on the CISM grid, without obvious imprinting of the CLM grid.</li>
<li><code class="docutils literal notranslate"><span class="pre">Accuracy</span></code>: The SMB applied in CISM at a given location is close to the value computed in CLM at that location
and elevation.</li>
<li><code class="docutils literal notranslate"><span class="pre">Sign</span> <span class="pre">preservation</span></code>: Any positive SMB in CLM maps to a positive SMB in CISM, and likewise for negative SMB.</li>
</ol>
<p>Here we describe the algorithm used by the coupler to satisfy these requirements.  First we introduce some notation:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">lfrac</span></code> is the fraction of a CLM grid cell that does not overlap the ocean grid and is treated as land.
Since the ocean and land grids are non-conforming, we can have 0 &lt; lfrac &lt; 1 in CLM cells near the ocean boundary.</li>
<li><code class="docutils literal notranslate"><span class="pre">Sg_icemask_g</span></code> is a binary mask on the CISM grid that identifies cells which are ice-covered and/or land-covered,
and therefore are eligible to apply a nonzero SMB from CLM.  (Ice-free land cells can apply a positive SMB,
and ice-covered cells can apply an SMB of either sign.)  CISM cells that are ice- and/or land-covered have
Sg_icemask_g = 1, and ice-free ocean cells have Sg_icemask_g = 0.  (How to handle equations in rst?)</li>
<li><code class="docutils literal notranslate"><span class="pre">Sg_icemask_l</span></code> is obtained by mapping <code class="docutils literal notranslate"><span class="pre">Sg_icemask_g</span></code> from the CISM grid to the CLM grid.
Since the grids are different, this mask is not binary; we can have 0 &lt; Sg_icemask_l &lt; 1.</li>
<li><code class="docutils literal notranslate"><span class="pre">g</span> <span class="pre">=</span> <span class="pre">min(lfrac,</span> <span class="pre">Sg_icemask_l)</span></code> is the fraction of CLM-computed SMB that is sent to CISM via the coupler.
The remaining SMB is not sent to CISM.  A fraction <code class="docutils literal notranslate"><span class="pre">lfrac</span> <span class="pre">-</span> <span class="pre">g</span></code> is sent by the coupler to the runoff model;
this is the fraction of the cell that is land-covered but does not overlap the CISM grid.  The remaining
fraction, <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">lfrac</span></code>, is not sent to CISM or the runoff model, because any precipitation in
the non-land part of a CLM cell has already fallen into the ocean.</li>
<li><em>A_i</em> is the area of a CLM grid cell.  CLM and the coupler agree on the grid cell area.</li>
<li><em>A_j</em> is the area of a CISM grid cell according to CISM; and A_j^c is the area according to the coupler.
These two areas are different because of the non-area-preserving stereographic projection used for CISM.</li>
<li><em>f_ik</em> is the fraction of CLM grid cell i occupied by glacier ice in elevation class k</li>
<li><em>q_ik</em> is the SMB of CLM grid cell i in elevation class k</li>
<li><em>q_j</em> is the SMB remapped to CISM grid cell j</li>
</ul>
<p>Using this notation, we can express the conservation requirement (1):</p>
<p>Here is a latex example:</p>
<div class="math notranslate nohighlight" id="equation-sample-eq">
<span class="eqno">(1)<a class="headerlink" href="#equation-sample-eq" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}\frac{3}{2} = 1.5\\\sum_i{g_i A_i \sum_k{f_{ik} q_{ik}}} = \sum_j{A_j q_j},\end{aligned}\end{align} \]</div>
<p>where the sum on the LHS is taken over grid cells i and columns k on the CLM grid, and
the sum on the RHS is taken over grid cells j on the CISM grid.</p>
<p>I love equation <a class="reference internal" href="#equation-sample-eq">(1)</a>.</p>
<p>To additionally satisfy sign preservation (4), this equation is replaced by two equations:
one for the accumulation zone (limited to cells and columns with q &gt; 0),
and one for the ablation zone (limited to cells and columns with q &lt; 0).</p>
<p>Requirements (2) and (3) are ensured by bilinear remapping in the horizontal, combined
with linear interpolation in elevation space. So in order to satisfy all four requirements,
we need to combine bilinear remapping with a normalization step that guarantees conservation
in the accumulation and ablation zones.</p>
<p>The algorithm proceeds as follows:</p>
<ol class="arabic simple">
<li>In CLM, compute the SMB for each grid cell and elevation class (EC) that has nonzero overlap (g &gt; 0)
with the CISM domain, and send to the coupler.</li>
<li>Accumulate and average the SMB for each EC over the CLM-CISM coupling interval
(typically 1 year).</li>
<li>At the end of the coupling interval, compute the total SMB in the accumulation and ablation zones of CLM.</li>
<li>For each EC, do a bilinear remapping of SMB from the CLM grid to the CISM grid.</li>
<li>For each CISM grid cell, do a linear interpolation in elevation space between adjacent ECs, to compute
the SMB at the CISM cell elevation.  If a cell lies above or below the range of elevations in the
various ECs, extrapolate the value from the highest or lowest EC, respectively.</li>
<li>Compute the total (uncorrected) SMB in the accumulation and ablation zones of CISM.</li>
<li>Apply a normalization correction for conservation.  For example, suppose that Q_acc^clm = 1.05 * Q_acc_cism,
where Q_acc is the total SMB in the accumulation zone of a given domain.  Then in every CISM cell
that lies in the accumulation zone, we would multiply the SMB by Q_acc^clm/Q_acc^cism = 1.05
(and similarly for the ablation zone).</li>
<li>Send the normalized SMB on the CISM grid to CISM.</li>
</ol>
<p>Step 1 is done in CLM at every time step.  The other steps are done in the coupler, with steps 3-8
carried out at the end of the coupling interval.</p>
<p>In practice, normalization factors usually fall between 0.9 and 1.1 at typical CESM global grid resolutions
of 1 or 2 degrees.  Thus, if an SMB of 1 m/yr is computed in CLM, the downscaled SMB in CISM might differ
by up to 10 percent.  If we were using a conservative rather than bilinear remapping, we would
also have differences up to about 10 percent, because of area distortions on CISM’s polar stereographic grid.
Thus the local errors for bilinear remapping and renormalization are similar to the local errors for conservative remapping.
Bilinear remapping, however, is far smoother; smoothness is obtained at the cost of local conservation.</p>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="acknowledgements.html" title="7. Acknowledgments"
             >next</a> |</li>
        <li class="right" >
          <a href="controlling-output.html" title="5. Controlling output from CISM and CLM"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CESM Land Ice CESM2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Gunter Leguy, William Lipscomb, Bill Sacks.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>