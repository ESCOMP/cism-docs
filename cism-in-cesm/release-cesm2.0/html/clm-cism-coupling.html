

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6. Coupling CLM and CISM &mdash; CESM Land Ice cesm2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="CESM Land Ice cesm2.0 documentation" href="index.html"/>
        <link rel="next" title="7. Acknowledgments" href="acknowledgements.html"/>
        <link rel="prev" title="5. Controlling output from CISM and CLM" href="controlling-output.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> CESM Land Ice
          

          
          </a>

          
            
            
              <div class="version">
                
                  <div class="version-dropdown">
                    <select class="version-list" id="version-list">
                      <option value=''>cesm2.0</option>
                      
                        
                          <option value="../../master">master</option>
                        
                      
                        
                      
                    </select>
                  </div>
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="running-and-modifying.html">2. Running and modifying the CESM land ice component</a></li>
<li class="toctree-l1"><a class="reference internal" href="t-compsets.html">3. Running the standalone ice sheet model within CESM: T compsets</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic-ice-sheet-model.html">4. The dynamic ice sheet model</a></li>
<li class="toctree-l1"><a class="reference internal" href="controlling-output.html">5. Controlling output from CISM and CLM</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Coupling CLM and CISM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#modes-of-coupling-clm-and-cism">6.1. Modes of coupling CLM and CISM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#one-way-diagnostic-coupling">6.1.1. One-way (diagnostic) coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#two-way-interactive-coupling">6.1.2. Two-way (interactive) coupling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#brief-overview-of-clm-cism-coupling">6.2. Brief overview of CLM-CISM coupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fields-exchanged-between-clm-and-cism">6.3. Fields exchanged between CLM and CISM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#clm-to-cism">6.3.1. CLM to CISM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cism-to-clm">6.3.2. CISM to CLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-fields-sent-from-cism">6.3.3. Other fields sent from CISM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#remapping-fields-between-clm-and-cism">6.4. Remapping fields between CLM and CISM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#remapping-surface-mass-balance-from-clm-to-cism">6.4.1. Remapping surface mass balance from CLM to CISM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">7. Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">8. References</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="new-grids.html">A.1&nbsp;&nbsp;&nbsp;Introducing a new ice sheet grid</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CESM Land Ice</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>6. Coupling CLM and CISM</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/clm-cism-coupling.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="coupling-clm-and-cism">
<span id="clm-cism-coupling"></span><h1>6. Coupling CLM and CISM<a class="headerlink" href="#coupling-clm-and-cism" title="Permalink to this headline">¶</a></h1>
<p>TODO: This section is under construction.  Several section heads are just placeholders for now.</p>
<div class="section" id="modes-of-coupling-clm-and-cism">
<h2>6.1. Modes of coupling CLM and CISM<a class="headerlink" href="#modes-of-coupling-clm-and-cism" title="Permalink to this headline">¶</a></h2>
<div class="section" id="one-way-diagnostic-coupling">
<h3>6.1.1. One-way (diagnostic) coupling<a class="headerlink" href="#one-way-diagnostic-coupling" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="two-way-interactive-coupling">
<h3>6.1.2. Two-way (interactive) coupling<a class="headerlink" href="#two-way-interactive-coupling" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="brief-overview-of-clm-cism-coupling">
<h2>6.2. Brief overview of CLM-CISM coupling<a class="headerlink" href="#brief-overview-of-clm-cism-coupling" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="fields-exchanged-between-clm-and-cism">
<h2>6.3. Fields exchanged between CLM and CISM<a class="headerlink" href="#fields-exchanged-between-clm-and-cism" title="Permalink to this headline">¶</a></h2>
<div class="section" id="clm-to-cism">
<h3>6.3.1. CLM to CISM<a class="headerlink" href="#clm-to-cism" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="cism-to-clm">
<h3>6.3.2. CISM to CLM<a class="headerlink" href="#cism-to-clm" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="other-fields-sent-from-cism">
<h3>6.3.3. Other fields sent from CISM<a class="headerlink" href="#other-fields-sent-from-cism" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="remapping-fields-between-clm-and-cism">
<h2>6.4. Remapping fields between CLM and CISM<a class="headerlink" href="#remapping-fields-between-clm-and-cism" title="Permalink to this headline">¶</a></h2>
<div class="section" id="remapping-surface-mass-balance-from-clm-to-cism">
<h3>6.4.1. Remapping surface mass balance from CLM to CISM<a class="headerlink" href="#remapping-surface-mass-balance-from-clm-to-cism" title="Permalink to this headline">¶</a></h3>
<p>As described above, the surface mass balance (SMB) of ice sheets is computed by CLM
for each column (i.e., elevation class) of each glaciated landunit in each grid cell on the land grid.
The SMB is then remapped by the coupler to the finer ice sheet grid and passed to CISM.
When CESM is run with two-way, interactive coupling between glaciers and ice sheets, we want to conserve
the total amount of water in the system, while also mapping SMB smoothly and accurately between grids.</p>
<p>Specifically, we would like the SMB remapping to satisfy the following requirements:</p>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">Conservation</span></code>: For any ice sheet defined by a CISM domain, the sum over CLM grid cells of the SMB sent to the coupler
is equal (within machine roundoff) to the sum over CISM grid cells of the SMB received from the coupler.
Note that this is a global (i.e., whole-ice-sheet) rather than a local requirement.</li>
<li><code class="docutils literal notranslate"><span class="pre">Smoothness</span></code>: The remapping is smooth and continuous on the CISM grid, without obvious imprinting of the coarser CLM grid.</li>
<li><code class="docutils literal notranslate"><span class="pre">Accuracy</span></code>: The SMB applied in CISM at a given location is close to the value computed by CLM at that location
and elevation.</li>
<li><code class="docutils literal notranslate"><span class="pre">Sign</span> <span class="pre">preservation</span></code>: Any positive SMB in CLM maps to a positive SMB in CISM, and likewise for negative SMB.</li>
</ol>
<p>Here we describe the algorithm used by the coupler to satisfy these requirements.  First we introduce some notation:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">lfrac</span></code> is the fraction of a CLM grid cell that does not overlap the ocean grid and is treated as land.
Since the ocean and land grids are non-conforming, we can have <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">lfrac</span> <span class="pre">&lt;</span> <span class="pre">1</span></code> in CLM cells near the ocean boundary.</li>
<li><code class="docutils literal notranslate"><span class="pre">Sg_icemask_g</span></code> is a binary mask on the CISM grid that identifies cells which are ice-covered and/or land-covered,
and therefore are eligible to apply a nonzero SMB from CLM.  (Ice-free land cells can have a positive SMB,
and ice-covered cells can have an SMB of either sign.)  CISM cells that are ice- and/or land-covered have
<code class="docutils literal notranslate"><span class="pre">Sg_icemask_g</span> <span class="pre">=</span> <span class="pre">1</span></code>, and ice-free ocean cells have <code class="docutils literal notranslate"><span class="pre">Sg_icemask_g</span> <span class="pre">=</span> <span class="pre">0</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">Sg_icemask_l</span></code> is obtained by mapping <code class="docutils literal notranslate"><span class="pre">Sg_icemask_g</span></code> from the CISM grid to the CLM grid.
Since the grids are different, this mask is not binary; we can have <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">Sg_icemask_l</span> <span class="pre">&lt;</span> <span class="pre">1</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">g</span> <span class="pre">=</span> <span class="pre">min(lfrac,</span> <span class="pre">Sg_icemask_l)</span></code> is the fraction of CLM-computed SMB that is sent to CISM via the coupler.
The remaining SMB is not sent to CISM.  A fraction <code class="docutils literal notranslate"><span class="pre">lfrac</span> <span class="pre">-</span> <span class="pre">g</span></code> is sent by the coupler to the runoff model;
this is the fraction of the cell that is land-covered but does not overlap the CISM grid.  The remaining
fraction, <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">lfrac</span></code>, is not sent to either CISM or the runoff model, because any precipitation in
the non-land part of a CLM cell has already fallen into the ocean.</li>
<li><span class="math notranslate nohighlight">\(A_i\)</span> is the area of a CLM grid cell.  CLM and the coupler agree on the grid cell area.</li>
<li><span class="math notranslate nohighlight">\(A_j\)</span> is the area of a CISM grid cell according to CISM, and <span class="math notranslate nohighlight">\(A_j^c\)</span> is the area according to the coupler.
These two areas differ because CISM’s stereographic projection does not conserve area.</li>
<li><span class="math notranslate nohighlight">\(f_{ik}\)</span> is the fraction of CLM grid cell <em>i</em> occupied by glacier ice in elevation class <em>k</em>.</li>
<li><span class="math notranslate nohighlight">\(q_{ik}\)</span> is the SMB of CLM grid cell <em>i</em> in elevation class <em>k</em>.</li>
<li><span class="math notranslate nohighlight">\(q_j\)</span> is the SMB remapped to CISM grid cell <em>j</em>.</li>
</ul>
<p>Using this notation, we can express the conservation requirement (1):</p>
<div class="math notranslate nohighlight" id="equation-conservation">
<span class="eqno">(1)<a class="headerlink" href="#equation-conservation" title="Permalink to this equation">¶</a></span>\[\sum_i{g_i A_i \sum_k{f_{ik} q_{ik}}} = \sum_j{A_j q_j},\]</div>
<p>where the sum on the LHS is taken over grid cells <em>i</em> and columns <em>k</em> on the CLM grid, and
the sum on the RHS is taken over grid cells <em>j</em> on the CISM grid.</p>
<p>To additionally satisfy sign preservation (4), Eq. <a class="reference internal" href="#equation-conservation">(1)</a> is replaced by two equations:
one for the accumulation zone (limited to cells and columns with <span class="math notranslate nohighlight">\(q &gt; 0\)</span>),
and one for the ablation zone (limited to cells and columns with <span class="math notranslate nohighlight">\(q &lt; 0\)</span>).</p>
<p>Requirements (2) and (3) are ensured by bilinear remapping in the horizontal plane combined
with linear interpolation in the vertical. These operations are smooth but not conservative.
Thus, in order to satisfy all four requirements, bilinear remapping and vertical interpolation
are followed by a normalization step that guarantees conservation in both the accumulation and ablation zones.</p>
<p>The algorithm proceeds as follows:</p>
<ol class="arabic simple">
<li>In CLM, compute the SMB for each grid cell and elevation class (EC) that has nonzero overlap (<span class="math notranslate nohighlight">\(g &gt; 0\)</span>)
with the CISM domain, and send to the coupler.</li>
<li>Accumulate and average the SMB for each EC over the CLM-CISM coupling interval
(typically 1 year).</li>
<li>At the end of the coupling interval, compute the total SMB in the accumulation and ablation zones of CLM.</li>
<li>For each EC, do a bilinear remapping of SMB from the CLM grid to the CISM grid.</li>
<li>For each CISM grid cell, do a linear interpolation in elevation space between adjacent ECs, to compute
the SMB at the CISM cell elevation.  If a cell lies above or below the range of elevations in the
various ECs, values from the highest and lowest ECs are extrapolated.  <em>Note: State whether this
is a linear extrapolation from the two highest and lowest ECs, or simply an extension of the highest and lowest values.</em></li>
<li>Compute the total (uncorrected) SMB in the accumulation and ablation zones of CISM.</li>
<li>Apply a normalization correction for conservation.  For example, suppose
<span class="math notranslate nohighlight">\(Q_{\text{acc}}^{\text{clm}} = 1.05 \, Q_{\text{acc}}^{\text{cism}}\)</span>,
where <span class="math notranslate nohighlight">\(Q_{\text{acc}}\)</span> is the total SMB in the accumulation zone of a given model.
Then in every CISM cell that lies in the accumulation zone, we would multiply the SMB by
<span class="math notranslate nohighlight">\(Q_{\text{acc}}^{\text{clm}}\, / \, Q_{\text{acc}}^{\text{cism}} = 1.05\)</span> (and similarly for the ablation zone).</li>
<li>Send the normalized SMB on the CISM grid to CISM.</li>
</ol>
<p>Step 1 is done in CLM at every time step.  The other steps are done in the coupler, with steps 3-8
carried out at the end of the coupling interval.</p>
<p>In practice, normalization factors usually fall between 0.9 and 1.1 at typical CESM global grid resolutions
of <span class="math notranslate nohighlight">\(\sim 1^\circ\)</span>.  Thus, if an SMB of 1 m/yr is computed in CLM, the downscaled SMB in CISM might differ
by up to 10%.  If we used conservative rather than bilinear remapping, differences also would be up to about 10%,
because of area distortions on CISM’s polar stereographic grid.
Thus the local errors for bilinear remapping and renormalization are similar to the local errors for conservative remapping.
Bilinear remapping, however, is far smoother; smoothness is obtained at the cost of local conservation.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="acknowledgements.html" class="btn btn-neutral float-right" title="7. Acknowledgments" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="controlling-output.html" class="btn btn-neutral" title="5. Controlling output from CISM and CLM" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Gunter Leguy, William Lipscomb, Bill Sacks.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
     
<script>var version_json_loc = "../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'cesm2.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="_static/pop_ver.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>